apiVersion: v1
kind: Secret
metadata:
  name: insightlearn-secrets
  namespace: insightlearn
type: Opaque
stringData:
  # SQL Server Password
  # Generate using: openssl rand -base64 32
  mssql-sa-password: "REPLACE_WITH_STRONG_PASSWORD"

  # JWT Secret Key (minimum 64 characters)
  # Generate using: ./scripts/generate-jwt-secret.sh
  # Or: openssl rand -base64 64 | tr -d '\n'
  jwt-secret-key: "REPLACE_WITH_JWT_SECRET_KEY_MINIMUM_64_CHARS_GENERATED_BY_SCRIPT"

  # Database Connection String
  # Update password to match mssql-sa-password above
  connection-string: "Server=sqlserver-service;Database=InsightLearnDb;User=sa;Password=REPLACE_WITH_STRONG_PASSWORD;TrustServerCertificate=true;MultipleActiveResultSets=true;Connection Timeout=30;Command Timeout=300"

  # MongoDB Password
  # Generate using: openssl rand -base64 32
  mongodb-password: "REPLACE_WITH_MONGODB_PASSWORD"

  # MongoDB Connection String
  # Update password to match mongodb-password above
  mongodb-connection-string: "mongodb://admin:REPLACE_WITH_MONGODB_PASSWORD@mongodb-service:27017/insightlearn?authSource=admin"

  # Redis Password
  # Generate using: openssl rand -base64 32
  redis-password: "REPLACE_WITH_REDIS_PASSWORD"

  # Admin credentials
  admin-email: "admin@insightlearn.cloud"
  # Generate using: openssl rand -base64 16
  admin-password: "REPLACE_WITH_ADMIN_PASSWORD"

---
# IMPORTANT SECURITY NOTES:
#
# 1. This is a TEMPLATE file. Copy it to 01-secrets.yaml and replace all placeholder values.
#    DO NOT commit the actual 01-secrets.yaml file to git (it's in .gitignore).
#
# 2. Generate cryptographically secure secrets:
#    - JWT Secret: ./scripts/generate-jwt-secret.sh
#    - Passwords: openssl rand -base64 32
#
# 3. Minimum requirements:
#    - JWT secret: 64 characters (enforced at startup)
#    - Passwords: 32 characters minimum
#    - Use only base64 characters (A-Z, a-z, 0-9, +, /)
#
# 4. Prohibited weak values (will be rejected by API):
#    - your-secret-key
#    - changeme
#    - default
#    - secret
#    - password
#    - replace_with
#    - insightlearn
#    - jwt_secret
#
# 5. Secret rotation:
#    - See docs/JWT-SECRET-ROTATION.md for detailed procedures
#    - Recommended frequency: Every 90 days
#
# 6. Backup secrets securely:
#    kubectl get secret insightlearn-secrets -n insightlearn -o yaml > secret-backup-$(date +%Y%m%d).yaml
#    Store backup in secure location (NOT in git)
#
# 7. Apply secrets to cluster:
#    kubectl apply -f k8s/01-secrets.yaml
#
# 8. Verify secrets:
#    kubectl get secret insightlearn-secrets -n insightlearn
#    kubectl describe secret insightlearn-secrets -n insightlearn
